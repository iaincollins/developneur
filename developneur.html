<head>
    <title>Air Travel</title>
    <script src="http://crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/md5.js"></script>
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet">
</head>

<body>
    {{> header}}
    <div class="container">
        {{#isolate}} {{renderPage}} {{/isolate}}
    </div>
</body>

<template name="header">
    <div class="navbar navbar-inverse navbar-static-top" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <a class="navbar-brand" href="/">
                <span class="fa-stack fa-lg pull-left">
                  <i class="fa fa-plane fa-stack-2x"></i>
                </span>
                <span class="pull-left">Air Travel</span>
            </a>
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
          </div>
          <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              <li class="hidden"><a id="" href="/forums">Airlines</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              {{ loginButtons }}
            </ul>
          </div>
        </div>
    </div>
</template>

<template name="home">
    <div class="row">
        <div class="col-sm-12">
            <h1>Home</h1>
        </div>
      </div>
  </div>
</template>

<template name='newForum'>
    <div class="row">
        <div class="col-sm-12">
            <h1>New Airline</h1>
            <form action='#'>
                <div class="form-group">
                    <label>Airline name</label>
                    <input id='nameOfForum' class="form-control" type='text' placeholder='Name of Forum' required />
                </div>
                <div class="form-group">
                    <label>Airline description</label>
                    <input id='descriptionOfForum' class="form-control" type='text' placeholder='Description of Forum' />
                </div>
                <input type='submit' class="btn btn-primary pull-right" value='Add new airline' />
            </form>
        </div>
    </div>
</template>

<template name='forums'>
    <div class="row">
        <div class="col-sm-8">
            <h1>Airlines
                {{#if loggedIn}}
                <a href="/new/forum" class="btn btn-primary pull-right">Add new airline</a>
                {{/if}}
            </h1>
        </div>
        <div class="col-sm-4">
            <a href="/new/post" class="pull-right unstyled"><h2>
                Make a complaint
                <span class="fa fa-arrow-circle-right"></span>
            </h2></a>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-8">
          {{#each allForums}}
          <hr/>
          <section class='{{this._id}} interactive'>
            <h3>
                <img height='48' class="pull-right" src='{{this.imageURL}}'/>
                {{this.name}}
                <span class="badge badge-lg pull-right">0 complaints</span>
            </h3>
            <p class="lead">{{this.description}}</p>
          </section>
          {{/each}}
        </div>
    </div>
</template>

<template name='forum'>
    <div class="row">
        <div class="col-sm-8">
            <h1>{{currentForum.name}} <small>Complaints</small>
                {{#if loggedIn}}
                    {{#if isOwnerOfForum}}
                        <span class='btn btn-danger pull-right' id='removeForum'>Remove airline</span>
                    {{/if}}
                {{/if}}
            </h1>
            <p class="lead">{{currentForum.description}}</p>
        </div>
        <div class="col-sm-4">
            <a href="/new/post" class="pull-right unstyled"><h2>
                Make a complaint
                <span class="fa fa-arrow-circle-right"></span>
            </h2></a>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-6">
            <hr/>
            <h2>Complaints</h2>
            {{#each currentPosts}}
            <div class="media clearfix">
                <img class="pull-left" height="48" width="48" src='{{currentUserGrav this}}' />
                <div class="media-body">
                <h3 class="margin-top-none">{{this.title}}</h1>
                <p class="lead">{{this.details}}</p>
                {{#if isOwnerOfPost this}}
                <span class='btn btn-danger removePost' data-post-id='{{this._id}}'>Remove Complaint</span>
                {{/if}}
                <br/>
                {{#each currentComments this._id}}
                    <section>
                        <div class="media clearfix margin-bottom">
                            <img class="pull-left" height="32" width="32" src='{{currentUserGrav this}}' />
                            <div class="media-body">
                                <p>{{this.comment}}</p>
                                {{#if isOwnerOfComment this}}
                                <span class='btn btn-danger removeComment' data-comment-id='{{this._id}}'>Remove Comment</span>
                                {{/if}}
                            </div>
                        </div>
                    </section>
                  {{/each}}
                <h5>ADD A COMMENT</h5>
                  <form action='#'>
                      <textarea type='text' class="form-control margin-bottom" placeholder='Comment' id='newCommentText' data-post-id='{{this._id}}' required></textarea>
                      <input type='submit' class="btn btn-primary pull-right" value='Comment' />
                  </form>
                 </div>
            </div>
            <hr/>
          {{/each}}
        </div>
    </div>
</template>

<template name='newPost'>
    <div class="row">
        <div class="col-sm-2">&nbsp;</div>
        <div class="col-sm-8">
            <h1>Make new complaint</h1>
            <form action='#'>
                <input id='newPostTitle' class="form-control margin-bottom" type='text' placeholder='Title' required/>
                <textarea id='newPostDetails'class="form-control margin-bottom" type='text' placeholder='Details'></textarea>
                <input type='submit' class="btn btn-primary pull-right" value='Create post' />
            </form>
        </div>
        <div class="col-sm-2">&nbsp;</div>
    </div>
</template>
